<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>My bot</title>
    <script src="./config.js"></script>
    <script src="./tmi.min.js"></script>
  </head>
  <body>
    <audio id="player" />
  </body>
  <script>
    const player = document.getElementById('player');
    const chat = new window.tmi.Client({
      options: { debug: true },
      connection: {
        reconnect: true,
        secure: true
      },
      // identity: {
      //   username: 'bot-name',
      //   password: 'oauth:my-bot-token'
      // },
      channels: [ config['channel'] ]
    });

    chat.connect();

    chat.on('message', (channel, tags, message, self) => {
      let data = message.split(' ');
      // !play <command>
      if (data[0] === '!play') {
        let command = data[1];
        // on parcours le tableau 'tracks'
        for(let idx in tracks) {
          // Si la command est trouv√©e
          if(command === tracks[idx]['command']) {
            console.log('lecture de ', tracks[idx]);
            player.src = `file:///${tracks[idx]['file']}`;
            player.play();
          }
        }
      }
    });
  </script>

</html>
